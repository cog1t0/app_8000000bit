<% remaining_days = [(bingo_card.expires_at.to_date - Date.current).to_i, 0].max %>
<% checked_cells = checker.checked_count %>
<% bingo_lines = checker.bingo_count %>

<div id="bingo_status" class="rounded-2xl bg-white px-6 py-5 shadow-xl ring-1 ring-slate-200">
  <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
    <div>
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-slate-400">Status</p>
      <h2 class="text-2xl font-bold text-slate-900"><%= bingo_card.title %></h2>
      <p class="text-sm text-slate-600">共有URLを開いた全員で同じカードを使えます。</p>
    </div>
    <div class="flex flex-wrap gap-2">
      <% if bingo_card.expired? %>
        <span class="rounded-full bg-red-100 px-3 py-1 text-xs font-semibold text-red-700">期限切れ</span>
      <% else %>
        <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">あと<%= remaining_days %>日あそべる</span>
      <% end %>
      <span class="rounded-full bg-indigo-100 px-3 py-1 text-xs font-semibold text-indigo-700">5 x 5 マス</span>
    </div>
  </div>

  <div class="mt-5 grid grid-cols-1 gap-4 md:grid-cols-3">
    <div class="rounded-xl bg-slate-50 px-4 py-3 ring-1 ring-slate-100">
      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">期限</p>
      <p class="text-lg font-bold text-slate-900"><%= l(bingo_card.expires_at, format: :long) %></p>
      <% unless bingo_card.expired? %>
        <p class="text-xs text-slate-500">残り <%= remaining_days %> 日</p>
      <% end %>
    </div>
    <div class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-100">
      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-emerald-600">達成マス</p>
      <p class="text-lg font-bold text-emerald-800"><%= checked_cells %> / 25</p>
      <div class="mt-2 h-2 w-full rounded-full bg-white/70">
        <% progress = ((checked_cells.to_f / 25) * 100).round %>
        <div class="h-2 rounded-full bg-emerald-500" style="width: <%= progress %>%"></div>
      </div>
    </div>
    <div class="rounded-xl bg-indigo-50 px-4 py-3 ring-1 ring-indigo-100">
      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-indigo-600">ビンゴ</p>
      <p class="text-lg font-bold text-indigo-900"><%= bingo_lines %> 本</p>
      <p class="text-xs text-indigo-700">縦・横・ななめのライン数</p>
    </div>
  </div>
</div>
